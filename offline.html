<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mode Hors Ligne - Djibli</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #f5f5f5;
        }
        .phone-frame {
            max-width: 390px;
            min-height: 844px;
            margin: 20px auto;
            background: white;
            border-radius: 40px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 0 10px #000;
        }
        .status-bar {
            padding: 14px 24px 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
        }
        .button-primary {
            background: #6366F1;
            color: white;
            padding: 12px;
            border-radius: 8px;
            width: 100%;
            text-align: center;
            font-weight: 500;
        }
        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #E5E7EB;
            border-radius: 8px;
            margin-top: 4px;
        }
        .form-label {
            font-size: 14px;
            color: #374151;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="phone-frame">
        <div class="status-bar">
            <span>9:41</span>
            <div class="flex items-center gap-1">
                <svg width="16" height="12" viewBox="0 0 16 12" fill="none">
                    <path d="M1 4.5C1 2.84315 2.34315 1.5 4 1.5H12C13.6569 1.5 15 2.84315 15 4.5V7.5C15 9.15685 13.6569 10.5 12 10.5H4C2.34315 10.5 1 9.15685 1 7.5V4.5Z" stroke="black"/>
                    <path d="M15.5 5.5V6.5" stroke="black" stroke-linecap="round"/>
                </svg>
                <svg width="16" height="12" viewBox="0 0 16 12" fill="none">
                    <path d="M1 1.5H15M1 6H15M1 10.5H15" stroke="black" stroke-width="2"/>
                </svg>
            </div>
        </div>

        <main class="p-6">
            <div class="flex items-center gap-4 mb-8">
                <button onclick="window.location.href='relais.html'">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <path d="M15 18L9 12L15 6" stroke="black" stroke-width="2"/>
                    </svg>
                </button>
                <h1 class="text-2xl font-semibold">Mode Hors Ligne</h1>
            </div>

            <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-6">
                <div class="flex items-start gap-3">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#F59E0B">
                        <path d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"/>
                    </svg>
                    <div>
                        <div class="font-medium text-yellow-800">Mode Hors Ligne Actif</div>
                        <div class="text-sm text-yellow-700">Les données seront synchronisées dès que la connexion sera rétablie</div>
                    </div>
                </div>
            </div>

            <div class="space-y-6 mb-8">
                <div class="bg-white border border-gray-200 rounded-xl p-4">
                    <div class="flex items-center justify-between mb-4">
                        <div class="font-medium">En attente de synchronisation</div>
                        <div class="text-sm text-gray-600">3 colis</div>
                    </div>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div>
                                <div class="font-medium">2024D69D3</div>
                                <div class="text-sm text-gray-600">Réceptionné à 11:30</div>
                            </div>
                            <div class="text-yellow-600">En attente</div>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div>
                                <div class="font-medium">2024E71F5</div>
                                <div class="text-sm text-gray-600">Réceptionné à 12:15</div>
                            </div>
                            <div class="text-yellow-600">En attente</div>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div>
                                <div class="font-medium">2024F82G7</div>
                                <div class="text-sm text-gray-600">Réceptionné à 12:45</div>
                            </div>
                            <div class="text-yellow-600">En attente</div>
                        </div>
                    </div>
                </div>

                <button onclick="checkConnection()" class="button-primary flex items-center justify-center gap-2">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/>
                    </svg>
                    Vérifier la connexion
                </button>
            </div>

            <div class="space-y-4">
                <div class="font-medium">Scanner un nouveau colis</div>
                <button onclick="window.location.href='scan.html'" class="flex items-center justify-center gap-2 w-full py-3 px-4 border border-gray-300 rounded-lg">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        <line x1="3" y1="9" x2="21" y2="9"/>
                        <line x1="3" y1="15" x2="21" y2="15"/>
                        <line x1="9" y1="3" x2="9" y2="21"/>
                        <line x1="15" y1="3" x2="15" y2="21"/>
                    </svg>
                    Scanner un QR code
                </button>
                <button onclick="showManualInput()" class="flex items-center justify-center gap-2 w-full py-3 px-4 border border-gray-300 rounded-lg">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                    </svg>
                    Saisie manuelle
                </button>
            </div>

            <!-- Modal pour la saisie manuelle -->
            <div id="manualInputModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
                <div class="bg-white rounded-xl p-6 m-4 max-w-sm w-full">
                    <h3 class="text-lg font-semibold mb-4">Saisie manuelle</h3>
                    <form class="space-y-4">
                        <div>
                            <label class="form-label">Numéro de colis</label>
                            <input type="text" class="form-input" placeholder="ex: 2024XXXXX">
                        </div>
                        <div>
                            <label class="form-label">Type d'opération</label>
                            <select class="form-input">
                                <option>Réception colis</option>
                                <option>Remise au destinataire</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label">Photo du colis</label>
                            <input type="file" accept="image/*" capture="environment" class="form-input">
                        </div>
                        <div class="flex gap-3">
                            <button type="button" onclick="hideManualInput()" class="flex-1 py-2 px-4 border border-gray-300 rounded-lg text-sm font-medium">
                                Annuler
                            </button>
                            <button type="submit" class="flex-1 py-2 px-4 bg-indigo-600 text-white rounded-lg text-sm font-medium">
                                Enregistrer
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Simuler le stockage local
        let offlineData = [];

        function showManualInput() {
            document.getElementById('manualInputModal').classList.remove('hidden');
        }

        function hideManualInput() {
            document.getElementById('manualInputModal').classList.add('hidden');
        }

        function checkConnection() {
            // Simuler une vérification de connexion
            const online = Math.random() > 0.5;
            if (online) {
                alert('Connexion rétablie ! Synchronisation en cours...');
                setTimeout(() => {
                    window.location.href = 'relais.html';
                }, 2000);
            } else {
                alert('Toujours hors ligne. Réessayez plus tard.');
            }
        }

        // Service Worker pour le mode hors ligne
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').then(function(registration) {
                console.log('ServiceWorker registration successful');
            }).catch(function(err) {
                console.log('ServiceWorker registration failed: ', err);
            });
        }
    </script>
</body>
</html>
